{{ template "page/head_start" .}}
<style>
    /* å¤åˆ¶è‡ª settings.html çš„æ ·å¼ï¼Œç¡®ä¿å¸ƒå±€å“åº”å¼ä¸€è‡´ */
    @media (min-width: 769px) {
        .ant-layout-content {
            margin: 24px 16px;
        }
    }
    /* ç§»åŠ¨ç«¯é€‚é… */
    @media (max-width: 768px) {
        .ant-layout-content {
            margin: 10px 10px;
        }
    }
    /* è°ƒæ•´è¡¨æ ¼å¡ç‰‡æ ·å¼ */
    .ant-card-body {
        padding: 24px;
    }

/* é’ˆå¯¹æš—è‰²ä¸»é¢˜ï¼ˆdark-themeï¼‰çš„ a-alert å¼ºåˆ¶æ ·å¼è¦†ç›– */
/* 1ã€å»æ‰æš—è‰²ä¸»é¢˜ä¸‹ Modal çš„é»˜è®¤ç°è‰²é®ç½©ï¼ˆè§£å†³â€œç°è’™è’™â€é—®é¢˜ï¼‰ */
/*
.dark-theme .ant-modal-mask {
    background: transparent !important;   /* å˜ä¸ºå®Œå…¨é€æ˜ï¼Œæ›´é€šé€ */
}  */

/* 1ã€åªå»æ‰è¿™ä¸ªå¼¹çª—çš„ç°è‰²é®ç½© */
.dark-theme .ping-check-modal + .ant-modal-wrap .ant-modal-mask,
.dark-theme .ping-check-modal .ant-modal-mask {
    background: transparent !important;
}

/* 2ã€å¼¹çª—ä¸­ info æç¤ºæ¡† å¼ºåˆ¶ä½¿ç”¨æµ…è‰²èƒŒæ™¯ + è“è‰²è¾¹æ¡† */
.ant-modal .ant-alert-info {
    background-color: #f0f8ff !important;   /* æµ…è“è‰²èƒŒæ™¯ */
    border: 1px solid #91d5ff !important;   /* è“è‰²è¾¹æ¡† */
    border-radius: 8px;                      /* åœ†è§’æ›´å¥½çœ‹ */
}

/* 3ã€å¼¹çª—ä¸­ a-alert å†…æ‰€æœ‰æ–‡å­—ï¼Œå¼ºåˆ¶ä¸ºæ·±è‰²ï¼ˆé˜²æ­¢å‘ç°/å‘ç™½ï¼‰ */
.ant-modal .ant-alert-info,
.ant-modal .ant-alert-info * {
    color: #333333 !important;              /* æ·±ç°æ–‡å­—ï¼Œæ›´æ¸…æ™° */
}

/* 4ã€å¼ºåˆ¶ info-circle å›¾æ ‡ä¸ºæ ‡å‡† Ant è“è‰²ï¼ˆæ¢å¤ä½ ä¹‹å‰çœ‹åˆ°çš„æ•ˆæœï¼‰ */
.ant-modal .ant-alert-info .anticon-info-circle {
    color: #1890ff !important;
}

/* 5ã€éƒ¨åˆ†æµè§ˆå™¨ä¼šæŠŠ svg å¡«å……è‰²å˜ç°ï¼Œè¿™é‡Œå¼ºåˆ¶ä¿®æ­£ */
.ant-modal .ant-alert-info svg {
    fill: #1890ff !important;
}
	
</style>
{{ template "page/head_end" .}}

{{ template "page/body_start" .}}
<a-layout id="app" v-cloak :class="themeSwitcher.currentTheme">
    <a-sidebar></a-sidebar>
    
    <a-layout id="content-layout">
        <a-layout-content>
            <a-spin :spinning="loading" tip="åŠ è½½ä¸­...">
                <transition name="list" appear>
                    <a-row :gutter="[isMobile ? 8 : 16, isMobile ? 0 : 12]">
                        <a-col>
                            <a-card hoverable>
                                <a-row>
                                    <a-col :span="24">
                                        <a-space :size="15">
                                            
                                            <a-button type="primary" @click="openAddModal(0)">
                                                <a-icon type="plus"></a-icon> æ·»åŠ ã€”è¢«æ§ç«¯ VPSã€•
                                            </a-button>

                                            <a-button type="primary" style="cursor: default;">
                                                <a-icon type="info-circle"></a-icon>
                                                å½“å‰å·²ç»‘å®šï¼š[[ normalCount ]] å° (æœ€å¤šå¯ç»‘ï¼š[[ maxLimit ]] å°)
                                            </a-button>

                                            <a-button type="default" icon="reload" @click="getServers">
                                                åˆ·æ–°åˆ—è¡¨
                                            </a-button>

                                            <a-button type="primary" icon="setting" @click="goToTgSettings">
                                                é…ç½®æœ¬æœºâ€œä¸»æ§æœºå™¨äººâ€
                                            </a-button>

                                        </a-space>
                                    </a-col>
                                </a-row>

                                <a-table :columns="columns" :data-source="normalServersPage" :row-key="record => record.ID" :pagination="normalPagination" @change="handleNormalTableChange" style="margin-top: 20px">
    <template slot="action" slot-scope="text, record">
        <a-space>
            <a-button type="danger" size="small" icon="delete" @click="deleteServer(record)">åˆ é™¤</a-button>
        </a-space>
    </template>
</a-table>
                            </a-card>
                            
<a-card hoverable title="ä¸€é”®éƒ¨ç½²ä¸­è½¬èŠ‚ç‚¹">
<a-row>
                                    <a-col :span="24">
                                        <div style="margin-bottom: 15px; color: #666;">
                                            <a-icon type="info-circle"></a-icon> 
                                            è¯´æ˜ï¼šåœ¨æ­¤æ·»åŠ è¿œç¨‹ä¸­è½¬æœºï¼ˆè½åœ°æœºï¼‰ä¿¡æ¯ï¼Œç‚¹å‡»â€œä¸€é”®éƒ¨ç½²â€å³å¯è‡ªåŠ¨å®Œæˆï¼š
                                            è¿œç¨‹Socksåˆ›å»º --> æœ¬æœºè·¯ç”±é…ç½® --> æœ¬æœºå…¥å£åˆ›å»º --> ç”Ÿæˆâ€œäºŒç»´ç å’Œé“¾æ¥â€ã€‚
                                        </div>
                                        <a-space :size="15">
                                            <a-button type="primary" @click="openAddModal(1)">
                <a-icon type="plus"></a-icon> æ·»åŠ ã€”ä¸­è½¬æœº VPSã€•
            </a-button>
            
            <a-button type="primary" style="cursor: default;">
                <a-icon type="info-circle"></a-icon>
                å½“å‰å·²ç»‘å®šï¼š[[ transitCount ]] å° (æœ€å¤šå¯ç»‘ï¼š[[ maxLimit ]] å°)
            </a-button>

            <a-button type="default" icon="reload" @click="getServers">
                åˆ·æ–°åˆ—è¡¨
            </a-button>

											<a-button type="primary" icon="thunderbolt" @click="openCheckModal">
                                                æ£€æµ‹ä¸­è½¬èŠ‚ç‚¹â€œè¿é€šæ€§â€
                                            </a-button>
                                        </a-space>
                                    </a-col>
                                </a-row>
    
    <a-table :columns="columns" :data-source="transitServersPage" :row-key="record => record.ID" :pagination="transitPagination" @change="handleTransitTableChange" :scroll="isMobile ? { x: 'max-content' } : {}" style="margin-top: 20px">
        <template slot="action" slot-scope="text, record">
            <a-space>
                <a-button v-if="record.LastLink || record.last_link" type="default" size="small" icon="link" @click="getLastLink(record)" :loading="record.linkLoading">
                    è·å–ä¸Šæ¬¡é“¾æ¥
                </a-button>
                
                <a-button type="primary" size="small" icon="rocket" @click="setupRelay(record)" :loading="record.setupLoading" :type="(record.LastLink || record.last_link) ? 'dashed' : 'primary'">
                    [[ (record.LastLink || record.last_link) ? 'é‡æ–°éƒ¨ç½²' : 'ä¸€é”®éƒ¨ç½²ä¸­è½¬' ]]
                </a-button>
                
                <a-button type="danger" size="small" icon="delete" @click="deleteServer(record)">åˆ é™¤</a-button>
            </a-space>
        </template>
    </a-table>
</a-card>
                            
                        </a-col>
                    </a-row>
                </transition>
            </a-spin>
        </a-layout-content>
    </a-layout>

  <a-modal v-model="visible" :title="formType === 1 ? 'æ·»åŠ ã€”ä¸­è½¬æœº VPSã€•' : 'æ·»åŠ ã€”è¢«æ§ç«¯ VPSã€•'" @ok="submitServer" :confirm-loading="modalLoading">
        <a-form :model="form" :label-col="{ span: 6 }" :wrapper-col="{ span: 16 }">
            <a-form-item label="å¤‡æ³¨åç§°">
                <a-input v-model="form.name" placeholder="ä¾‹å¦‚ï¼šé¦™æ¸¯é¸¡"></a-input>
            </a-form-item>
            <a-form-item label="é¢æ¿åœ°å€">
                <a-input v-model="form.url" placeholder="https://aaa.xxxx.com:54321/nbxuiplus"></a-input>
                <span style="font-size: 12px; color: #888;">* å¿…é¡»åŒ…å«åè®®å¤´ (https://) å’Œ â€œç«¯å£ + è·¯å¾„â€</span>
            </a-form-item>
            <a-form-item label="ç”¨ æˆ· å">
                <a-input v-model="form.username" placeholder="é¢æ¿ç™»å½•ç”¨æˆ·å"></a-input>
            </a-form-item>
            <a-form-item label="ç™»å½•å¯†ç ">
                <a-input-password v-model="form.password" placeholder="é¢æ¿ç™»å½•å¯†ç "></a-input-password>
            </a-form-item>
        </a-form>

        <div v-if="formType === 0" style="margin-top: 20px; color: red; font-style: italic; text-align: center; line-height: 1.6;">
            1ã€æ­¤åŠŸèƒ½ç”¨äºé›†ä¸­ç®¡ç†å¤šä¸ªã€”X-Panel é¢æ¿ã€•ï¼Œ<br>
            2ã€æ˜¯é€šè¿‡åœ¨åå°ã€”é…ç½®ç»‘å®šæœºå™¨äººã€•å»ç®¡ç†çš„ï¼Œ<br>
            3ã€è‹¥åœ¨è¾“å…¥æ¡†æ‚¨å·²ç»æ·»åŠ äº†ã€”è¢«æ§ç«¯ çš„ VPS ä¿¡æ¯ã€•ï¼Œ<br>
            4ã€åˆ™æ‚¨ä¸èƒ½åœ¨å¯¹åº”çš„é‚£å° VPS ä¸­å»ç»‘å®šä»»ä½•å…¶ä»–æœºå™¨äººï¼Œ<br>
            5ã€å¹¶ä¸”ï¼Œæ‚¨çš„ã€”è¢«æ§ç«¯ VPSã€•é¢æ¿ä¸èƒ½å»å¼€å¯â€œä¸¤æ­¥éªŒè¯â€ã€‚
        </div>

         <div v-else style="margin-top: 20px; color: #1890ff; font-style: italic; text-align: center; line-height: 1.6;">
        1ã€æ­¤åŠŸèƒ½ä»…ç”¨äºå»ºç«‹ã€”VLESS Reality --> Socks5ã€•ä¸­è½¬é“¾è·¯ï¼Œ<br>
        2ã€åœ¨æ­¤å¤„æ·»åŠ çš„ã€”ä¸­è½¬/è½åœ°æœº VPSã€•é¢æ¿ä¸èƒ½å»å¼€å¯â€œä¸¤æ­¥éªŒè¯â€ï¼Œ<br>
        3ã€åœ¨æ·»åŠ è¾“å…¥ä¿¡æ¯åï¼Œè¯·ç‚¹å‡»åˆ—è¡¨ä¸­çš„â€œä¸€é”®éƒ¨ç½²â€æŒ‰é’®å³å¯å»ä½¿ç”¨ï¼Œ<br>
        4ã€è€Œâ€œä¸­è½¬/è½åœ°æœºâ€æ— éœ€åšä»»ä½•è®¾ç½®ï¼Œåªéœ€ç¡®ä¿é˜²ç«å¢™æ”¾è¡Œç«¯å£å³å¯ï¼Œ<br>
        5ã€æœ€å¥½ä¸è¦è¿â€œæœ¬æœºèŠ‚ç‚¹â€å»ç”¨ã€”ä¸€é”®éƒ¨ç½²ã€•ï¼Œå› â€œXrayé‡å¯â€ä¼šæœ‰å¡é¡¿ï¼Œ<br>
        6ã€æ³¨ï¼šåœ¨å·²ç»åˆ›å»ºå¥½â€œä¸­è½¬èŠ‚ç‚¹â€ä¹‹åï¼Œå‹¿å»éšæ„æ›´æ”¹â€œç”¨æˆ·Email + ç«¯å£â€ã€‚
         </div>

    </a-modal>

<a-modal v-model="resultModalVisible" :title="resultTitle" :footer="null" :width="450">
		<div style="text-align: center;">

			<div style="text-align: left; color: #555; white-space: pre-wrap; line-height: 1.6; margin-bottom: 20px;">[[ resultSubtitle ]]</div>

			<p style="color: #888; margin-bottom: 5px;">é“¾è·¯ï¼šæœ¬æœº(Reality) --->> ä¸­è½¬æœº(Socks) --->> äº’è”ç½‘</p>

			<div 
				id="qrcode-canvas" 
				style="display: flex; justify-content: center; margin: 10px 0; cursor: pointer;" 
				title="ç‚¹å‡»å¤åˆ¶é“¾æ¥" 
				@click="copyLink"
			></div>
			<p style="font-size: 12px; color: #aaa;">(ç‚¹å‡»äºŒç»´ç æˆ–é“¾æ¥å³å¯å¤åˆ¶)</p>

			<p style="font-weight:bold; margin-top:15px; text-align: left;">ğŸ‘‡ VLESS Reality ä¸­è½¬é“¾æ¥ï¼š</p>
			<a-input v-model="resultLink" read-only @click="copyLink">
				<a-icon slot="addonAfter" type="copy" @click="copyLink" style="cursor: pointer;"/>
			</a-input>
		</div>
	</a-modal>

<a-modal v-model="checkModalVisible" title="æ£€æµ‹ä¸­è½¬èŠ‚ç‚¹â€œè¿é€šæ€§â€" :footer="null" width="700px">

    <!-- è¿™é‡Œæ˜¯æç¤ºæ¡†ï¼šåœ¨æš—é»‘æ¨¡å¼ä¸‹æ–‡å­—çœ‹ä¸æ¸…çš„åœ°æ–¹ -->
    <a-alert
        type="info"
        show-icon
        bordered
        style="margin-bottom: 15px;"
    >
        <template slot="message">
            æ­¤åŠŸèƒ½é€šè¿‡ TCP Ping æ¨¡æ‹Ÿ v2rayN æµ‹è¯•åŸç†ï¼Œ<br><br>
            æ£€æµ‹ã€”ä¸Šæ¬¡éƒ¨ç½²ç”Ÿæˆçš„é“¾æ¥ã€•å¯¹åº”çš„ç«¯å£æ˜¯å¦é€šç•…ï¼Ÿ
        </template>
    </a-alert>
        
        <a-table 
            :columns="checkColumns" 
            :data-source="checkList" 
            :row-key="record => record.ID" 
            :pagination="false"
            size="small"
        >
            <template slot="status" slot-scope="text, record">
                <span v-if="record.pingLoading">
                    <a-icon type="loading" /> æ£€æµ‹ä¸­...
                </span>
                <span v-else>
                    <a-tag v-if="record.pingResult === undefined">å¾…æ£€æµ‹</a-tag>
                    <a-tag v-else-if="record.pingResult > 0" color="green">æ­£å¸¸: [[ record.pingResult ]]ms</a-tag>
                    <a-tag v-else color="red">æ— æ•ˆ / ä¸é€š</a-tag>
                </span>
            </template>
            <template slot="action" slot-scope="text, record">
                <a-button type="primary" size="small" ghost @click="performPing(record)" :loading="record.pingLoading">
                    ç«‹å³æ£€æµ‹
                </a-button>
            </template>
        </a-table>
        <div style="margin-top: 20px; text-align: right;">
             <a-button @click="checkModalVisible = false">å…³é—­</a-button>
        </div>
    </a-modal>

</a-layout>

{{template "page/body_scripts" .}}
{{template "component/aSidebar" .}}
{{template "component/aThemeSwitch" .}}

<script>
    // åˆå§‹åŒ– Vue å®ä¾‹
    const app = new Vue({
        // é‡è¦ï¼šä¿®æ”¹ Vue åˆ†éš”ç¬¦ï¼Œé˜²æ­¢ä¸ Go æ¨¡æ¿å¼•æ“å†²çª
        delimiters: ['[[', ']]'], 
        // ã€å…³é”®ä¿®å¤ã€‘ï¼šå¼•å…¥ MediaQueryMixinï¼Œè¿™èƒ½è®©å¸ƒå±€åƒ settings.html ä¸€æ ·è‡ªåŠ¨é€‚åº”ï¼Œæ¶ˆé™¤å¼‚å¸¸é—´éš™
        mixins: [MediaQueryMixin],
        el: '#app',
        data: {
            themeSwitcher, // å¼•å…¥ä¸»é¢˜åˆ‡æ¢æ•°æ®
            loading: false,
            modalLoading: false,
            visible: false,
			checkModalVisible: false,
            resultModalVisible: false,
            resultTitle: 'éƒ¨ç½²ç»“æœ',
            resultSubtitle: '',
            resultLink: '',
			
			checkList: [],
            checkColumns: [
                { title: 'ID', dataIndex: 'ID', key: 'ID', width: 60 },
                { title: 'èŠ‚ç‚¹åç§°', dataIndex: 'name', key: 'name' },
                { title: 'çŠ¶æ€', key: 'status', scopedSlots: { customRender: 'status' } },
                { title: 'æ“ä½œ', key: 'action', scopedSlots: { customRender: 'action' }, align: 'right' }
            ],

            servers: [],
            // ã€ä¿®æ”¹è¿™é‡Œã€‘ï¼šå®šä¹‰ä¸¤ä¸ªç‹¬ç«‹çš„è®¡æ•°å˜é‡
            normalCount: 0,  // è¢«æ§ç«¯æ•°é‡
            transitCount: 0, // ä¸­è½¬æœºæ•°é‡
            maxLimit: 0,
            // ã€æ–°å¢æ•°æ®å­—æ®µç»“æŸã€‘
            form: {
                name: '',
                url: '',
                username: '',
                password: '',
                type: 0
            },
            
            // ç”¨äºæ§åˆ¶æ¨¡æ€æ¡†æ˜¾ç¤ºçš„ç±»å‹çŠ¶æ€ (0=è¢«æ§ç«¯, 1=ä¸­è½¬æœº)
            formType: 0,
            // ã€åˆ†é¡µæ–°å¢ã€‘ï¼šåˆ†é¡µé…ç½®
            paginationConfig: {
                pageSize: 5, // æ¯é¡µæ˜¾ç¤º5æ¡
                showSizeChanger: false,
                hideOnSinglePage: true,
            },
            // ã€åˆ†é¡µæ–°å¢ã€‘ï¼šå½“å‰é¡µæ•°
            normalCurrentPage: 1,
            transitCurrentPage: 1,
            
            // è¡¨æ ¼åˆ—å®šä¹‰
            columns: [
                { title: 'ID', dataIndex: 'ID', key: 'ID', width: 80 },
                { title: 'å¤‡æ³¨åç§°', dataIndex: 'name', key: 'name' },
                { title: 'é¢æ¿åœ°å€', dataIndex: 'url', key: 'url' },
                { title: 'ç”¨æˆ·å', dataIndex: 'username', key: 'username' },
                { 
                    title: 'æ·»åŠ æ—¶é—´', 
                    dataIndex: 'CreatedAt', // ä¿®æ”¹ç‚¹1ï¼šè¿™é‡Œå¿…é¡»æ”¹æˆå¤§å†™çš„ CreatedAt
                    key: 'CreatedAt',
                    width: 180,
                    // ä¿®æ”¹ç‚¹2ï¼šæ·»åŠ æ ¼å¼åŒ–ï¼ŒæŠŠ "2023-11-21T..." å˜æˆ "2023-11-21 10:00"
                    customRender: (text) => {
                        if (!text) return '';
                        // ç®€å•å¤„ç†ï¼šå»æ‰ Tï¼Œæˆªå–å‰19ä½
                        return text.replace('T', ' ').substring(0, 19);
                    }
                },
                { title: 'æ“ä½œ', key: 'action', scopedSlots: { customRender: 'action' }, width: 220 }
            ]
        },

            computed: {
            // è¿‡æ»¤æ™®é€šè¢«æ§ç«¯ (type=0)
            normalServers() {
                return this.servers.filter(s => s.type === 0 || s.type === undefined);
            },
            // è¿‡æ»¤ä¸­è½¬æœº (type=1)
            transitServers() {
                return this.servers.filter(s => s.type === 1);
            },
            
            // ã€åˆ†é¡µæ ¸å¿ƒã€‘ï¼šæ™®é€šè¢«æ§ç«¯ - å½“å‰é¡µæ•°æ® (è¿”å›ç©ºåˆ—è¡¨)
            normalServersPage() {
                // å› ä¸º this.normalServers å§‹ç»ˆä¸ºç©ºï¼Œæ‰€ä»¥è¿™é‡Œè¿”å›ç©º
                return [];
            },
            // ã€åˆ†é¡µæ ¸å¿ƒã€‘ï¼šä¸­è½¬æœº - å½“å‰é¡µæ•°æ® (è¿”å›ç©ºåˆ—è¡¨)
            transitServersPage() {
                 // å› ä¸º this.transitServers å§‹ç»ˆä¸ºç©ºï¼Œæ‰€ä»¥è¿™é‡Œè¿”å›ç©º
                return [];
            },

            // ã€åˆ†é¡µæ ¸å¿ƒã€‘ï¼šåˆ†é¡µå¯¹è±¡ (total å§‹ç»ˆä¸º 0)
            normalPagination() {
                return {...this.paginationConfig, current: this.normalCurrentPage, total: 0};
            },
            // ã€åˆ†é¡µæ ¸å¿ƒã€‘ï¼šåˆ†é¡µå¯¹è±¡ (total å§‹ç»ˆä¸º 0)
            transitPagination() {
                return {...this.paginationConfig, current: this.transitCurrentPage, total: 0};
            },
        },
        
        methods: {
            // ã€æ–°å¢è·³è½¬é€»è¾‘ã€‘
            // ç‚¹å‡»åè·³è½¬åˆ° settings é¡µé¢ï¼Œå¹¶å¸¦ä¸Š query å‚æ•° tab=telegram
            goToTgSettings() {
                window.location.href = "./settings?tab=telegram"; 
            },

            // ã€åˆ†é¡µæ–°å¢ã€‘ï¼šå¤„ç†æ™®é€šåˆ—è¡¨åˆ†é¡µåˆ‡æ¢
            handleNormalTableChange(pagination) {
                this.normalCurrentPage = pagination.current;
            },
            // ã€åˆ†é¡µæ–°å¢ã€‘ï¼šå¤„ç†ä¸­è½¬åˆ—è¡¨åˆ†é¡µåˆ‡æ¢
            handleTransitTableChange(pagination) {
                this.transitCurrentPage = pagination.current;
            },

            // ã€æ‹¦æˆªæ–¹æ³•ã€‘ï¼šæ‹¦æˆªè·å–é“¾æ¥æ“ä½œ
            getLastLink(record) {
                 // ã€å…è´¹ç‰ˆã€‘ï¼šæ‹¦æˆªè·å–é“¾æ¥æ“ä½œ
                this.$message.warning("ã€”å…è´¹åŸºç¡€ç‰ˆã€•ä¸æ”¯æŒæ­¤æ“ä½œ");
                return;
            },

             // æ‰§è¡Œä¸€é”®ä¸­è½¬éƒ¨ç½²
            async setupRelay(record) {
                 // ã€å…è´¹ç‰ˆä¿®æ”¹ã€‘ï¼šæ‹¦æˆªéƒ¨ç½²æ“ä½œ
                this.$message.warning("ã€”å…è´¹åŸºç¡€ç‰ˆã€•ä¸æ”¯æŒæ­¤æ“ä½œ");
                return;
            },

            // è·å–æœåŠ¡å™¨åˆ—è¡¨
            async getServers() {
                // 1. æ¨¡æ‹ŸåŠ è½½ç»“æŸ
                this.loading = false;
                // 2. å¼ºåˆ¶æ¸…ç©ºåˆ—è¡¨
                this.servers = []; 
                // 3. ã€å…³é”®ã€‘ï¼šå¼ºåˆ¶è®¾ç½®æ•°é‡å’Œé¢åº¦ä¸º 0
                this.normalCount = 0;
                this.transitCount = 0;
                this.maxLimit = 0; // å¼ºåˆ¶æ˜¾ç¤ºâ€œæœ€å¤šå¯ç»‘ï¼š0 å°â€
            },


            // æ‰“å¼€æ·»åŠ å¼¹çª—
            // openAddModal æ–¹æ³•æ¥æ”¶ type å‚æ•°
            // type: 0 = æ™®é€šè¢«æ§ç«¯, 1 = ä¸­è½¬æœº
            openAddModal(type = 0) {
                // 1. è®¾ç½®å½“å‰æ¨¡æ€æ¡†çš„ UI ç±»å‹
                this.formType = type;
                
                // 2. åˆå§‹åŒ–è¡¨å•ï¼Œå¹¶å°† type å†™å…¥è¡¨å•æ•°æ®ä¸­
                this.form = { 
                    name: '', 
                    url: 'https://', 
                    username: '', 
                    password: '',
                    type: type // ã€å…³é”®ã€‘ï¼šè¿™é‡Œç¡®ä¿æäº¤ç»™åç«¯çš„æ•°æ®åŒ…å«æ­£ç¡®çš„ç±»å‹
                };
                
                this.visible = true;
            },

            // æäº¤æ·»åŠ è¯·æ±‚
            async submitServer() {
                
                // 1. å…ˆå…³é—­åˆšæ‰å¡«å†™çš„æ¨¡æ€æ¡†ï¼Œ
                this.visible = false;

                // 2. ä½¿ç”¨ Vue çš„ createElement å‡½æ•°æ„å»ºæ”¯æŒ HTML çš„æç¤ºå†…å®¹
                const h = this.$createElement;
                
                // 3. å¼¹å‡ºè­¦å‘Šæç¤ºæ¡†
                this.$warning({
                    title: 'åŠŸèƒ½å—é™æç¤º',
                    okText: 'çŸ¥é“äº†',
                    // ã€æ ¸å¿ƒä¿®æ”¹ç‚¹ 1ã€‘ï¼šè°ƒæ•´å¼¹çª—å®½åº¦ï¼Œä½¿å…¶è¶³å¤Ÿå®¹çº³ä¸€è¡Œæ–‡å­—
                    width: 580, 
                    // è¿™é‡Œå®šä¹‰æç¤ºæ¡†çš„å…·ä½“å†…å®¹å’Œæ ·å¼
                    content: h('div', { style: 'margin-top: 10px; font-size: 15px; line-height: 1.6;' }, [ // å¢åŠ è¡Œé«˜ï¼Œæå‡é˜…è¯»ä½“éªŒ
                        
                        // ç¬¬ä¸€æ®µï¼šè®¾ç½®åº•éƒ¨å¤–è¾¹è·ï¼Œæ¨¡æ‹Ÿç©ºè¡Œ
                        h('p', { style: 'margin-bottom: 15px;' }, 'æ­¤é¡¹åŠŸèƒ½æ˜¯â€œä»˜è´¹Proç‰ˆâ€ä¸“å±åŠŸèƒ½ï¼Œå…è´¹ç‰ˆä¸èƒ½ç”¨ï¼Œ'), 
                        
                        // ç¬¬äºŒæ®µï¼šè®¾ç½®åº•éƒ¨å¤–è¾¹è·ï¼Œæ¨¡æ‹Ÿç©ºè¡Œ
                        h('p', { style: 'margin-bottom: 15px;' }, 'è¯·è”ç³»é¢æ¿ç®¡ç†å‘˜ã€”è´­ä¹°æˆæƒç ã€•ä¹‹åæ‰èƒ½ç»§ç»­ä½¿ç”¨ã€‚'), 
                        
                        // ç¬¬ä¸‰æ®µï¼šTG é“¾æ¥ï¼ˆæ— éœ€åº•éƒ¨å¤–è¾¹è·ï¼‰
                        h('p', { style: 'color: #ff4d4f; font-weight: bold; margin-bottom: 0;' }, [
                            '----->>> â€œæˆæƒç è´­ä¹°â€æœºå™¨äººï¼š',
                            h('a', { 
                                // è®¾ç½®è·³è½¬é“¾æ¥åˆ° Telegram
                                attrs: { 
                                    href: 'https://t.me/Buy_ShouQuan_Bot', 
                                    target: '_blank' // åœ¨æ–°æ ‡ç­¾é¡µæ‰“å¼€
                                }, 
                                style: { 
                                    color: '#1890ff', // é“¾æ¥é¢œè‰²
                                    fontWeight: 'bold',
                                    textDecoration: 'underline' // é“¾æ¥ä¸‹åˆ’çº¿
                                } 
                            }, '@Buy_ShouQuan_Bot')
                        ]),
                    ]),
                    onOk() {}
                });
            },

            // åˆ é™¤æœåŠ¡å™¨
            deleteServer(record) {
                // ã€å…è´¹ç‰ˆä¿®æ”¹ã€‘ï¼šæ‹¦æˆªåˆ é™¤æ“ä½œ
                this.$message.warning("ã€”å…è´¹åŸºç¡€ç‰ˆã€•ä¸æ”¯æŒæ­¤æ“ä½œ");
                return; 
            },

             // ã€æ‹¦æˆªæ–¹æ³•ã€‘ï¼šæ‹¦æˆªã€æ£€æµ‹ä¸­è½¬èŠ‚ç‚¹ã€‘æ“ä½œ
            openCheckModal() {
                // ã€å…è´¹ç‰ˆä¿®æ”¹ã€‘ï¼šæ‹¦æˆªã€æ£€æµ‹ä¸­è½¬èŠ‚ç‚¹ã€‘æ“ä½œ
                this.$message.warning("ã€”å…è´¹åŸºç¡€ç‰ˆã€•ä¸æ”¯æŒæ­¤æ“ä½œ");
                return; 
            },
			copyLink() {
                if(!this.resultLink) return;
                const input = document.createElement('input');
                input.value = this.resultLink;
                document.body.appendChild(input);
                input.select();
                document.execCommand('Copy');
                document.body.removeChild(input);
                this.$message.success('å¤åˆ¶æˆåŠŸ');
            },
            performPing(record) {
                 // å ä½
            }
        },
        mounted() {
            this.getServers();
        }
    });
</script>
{{ template "page/body_end" .}}




